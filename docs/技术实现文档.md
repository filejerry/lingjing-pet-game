# ã€Šçµå¢ƒæ–—å® å½•ã€‹æŠ€æœ¯å®ç°æ–‡æ¡£

**ç‰ˆæœ¬**: 2.0.0 - ä¸–ç•Œæ ‘çºªå…ƒ  
**ä½œè€…**: æ ‘æ (å¾®ä¿¡: wzq8083)  
**åˆ›å»ºæ—¥æœŸ**: 2025å¹´9æœˆ26æ—¥  

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
2. [æ ¸å¿ƒæ¨¡å—å®ç°](#æ ¸å¿ƒæ¨¡å—å®ç°)
3. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
4. [APIæ¥å£è®¾è®¡](#apiæ¥å£è®¾è®¡)
5. [å‰ç«¯æ¶æ„](#å‰ç«¯æ¶æ„)
6. [AIé›†æˆæ–¹æ¡ˆ](#aié›†æˆæ–¹æ¡ˆ)
7. [éƒ¨ç½²æ–¹æ¡ˆ](#éƒ¨ç½²æ–¹æ¡ˆ)
8. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·ç•Œé¢å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Webå‰ç«¯ (HTML5/CSS3/JS)  â”‚  ç§»åŠ¨ç«¯ (æœªæ¥)  â”‚  Steamå®¢æˆ·ç«¯ (æœªæ¥) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        APIç½‘å…³å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Express.jsè·¯ç”±  â”‚  ä¸­é—´ä»¶ç³»ç»Ÿ  â”‚  é”™è¯¯å¤„ç†  â”‚  å®‰å…¨éªŒè¯        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       ä¸šåŠ¡é€»è¾‘å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¸¸æˆæ ¸å¿ƒ  â”‚  å‰§æƒ…ç³»ç»Ÿ  â”‚  è¿›åŒ–ç³»ç»Ÿ  â”‚  AIå¼•æ“  â”‚  æˆ˜æ–—ç³»ç»Ÿ      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        æ•°æ®è®¿é—®å±‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SQLiteæ•°æ®åº“  â”‚  æ–‡ä»¶å­˜å‚¨  â”‚  ç¼“å­˜ç³»ç»Ÿ  â”‚  å¤–éƒ¨APIé›†æˆ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
graph TD
    A[ç”¨æˆ·ç•Œé¢] --> B[APIç½‘å…³]
    B --> C[æ¸¸æˆæ ¸å¿ƒ]
    B --> D[å‰§æƒ…ç³»ç»Ÿ]
    B --> E[è¿›åŒ–ç³»ç»Ÿ]
    C --> F[æ•°æ®åº“]
    D --> G[AIå¼•æ“]
    E --> G
    G --> H[å¤–éƒ¨AI API]
    C --> I[ç¼“å­˜ç³»ç»Ÿ]
    D --> I
    E --> I
```

---

## ğŸ”§ æ ¸å¿ƒæ¨¡å—å®ç°

### 1. æ¸¸æˆæ ¸å¿ƒç³»ç»Ÿ (src/game/)

#### PetManager.js - å® ç‰©ç®¡ç†å™¨
```javascript
class PetManager {
    constructor(database, aiEngine) {
        this.db = database;
        this.aiEngine = aiEngine;
        this.petCache = new Map();
    }

    // åˆ›å»ºå® ç‰©
    async createPet(template, playerId) {
        const pet = {
            id: this.generateId(),
            playerId: playerId,
            name: template.name,
            species: template.species,
            rarity: template.rarity,
            level: 1,
            exp: 0,
            stats: { ...template.baseStats },
            traits: [...template.traits],
            personality: template.personality,
            mood: 'neutral',
            bond: 0,
            createdAt: new Date().toISOString()
        };

        await this.db.pets.create(pet);
        this.petCache.set(pet.id, pet);
        return pet;
    }

    // æ›´æ–°å® ç‰©å±æ€§
    async updatePet(petId, updates) {
        const pet = await this.getPet(petId);
        if (!pet) throw new Error('å® ç‰©ä¸å­˜åœ¨');

        Object.assign(pet, updates);
        await this.db.pets.update(petId, pet);
        this.petCache.set(petId, pet);
        
        return pet;
    }

    // å® ç‰©å‡çº§
    async levelUp(petId) {
        const pet = await this.getPet(petId);
        if (!pet) throw new Error('å® ç‰©ä¸å­˜åœ¨');

        pet.level += 1;
        pet.exp = 0;
        
        // å±æ€§æˆé•¿
        const growth = this.calculateStatGrowth(pet);
        Object.keys(growth).forEach(stat => {
            pet.stats[stat] += growth[stat];
        });

        await this.updatePet(petId, pet);
        return pet;
    }
}
```

#### BattleSystem.js - æˆ˜æ–—ç³»ç»Ÿ
```javascript
class BattleSystem {
    constructor(database) {
        this.db = database;
        this.battleCache = new Map();
    }

    // åˆ›å»ºæˆ˜æ–—
    async createBattle(playerPet, enemyPet, battleType = 'wild') {
        const battle = {
            id: this.generateBattleId(),
            playerPet: playerPet,
            enemyPet: enemyPet,
            type: battleType,
            turn: 1,
            phase: 'preparation',
            log: [],
            startTime: Date.now()
        };

        this.battleCache.set(battle.id, battle);
        return battle;
    }

    // æ‰§è¡Œå›åˆ
    async executeTurn(battleId, playerAction) {
        const battle = this.battleCache.get(battleId);
        if (!battle) throw new Error('æˆ˜æ–—ä¸å­˜åœ¨');

        // è®¡ç®—è¡ŒåŠ¨é¡ºåº
        const actionOrder = this.calculateActionOrder(
            battle.playerPet, 
            battle.enemyPet
        );

        // æ‰§è¡Œè¡ŒåŠ¨
        for (const actor of actionOrder) {
            if (actor.isPlayer) {
                await this.executePlayerAction(battle, playerAction);
            } else {
                await this.executeEnemyAction(battle);
            }

            // æ£€æŸ¥æˆ˜æ–—ç»“æŸæ¡ä»¶
            if (this.checkBattleEnd(battle)) {
                break;
            }
        }

        battle.turn += 1;
        return battle;
    }

    // è®¡ç®—ä¼¤å®³
    calculateDamage(attacker, defender, skill) {
        const baseDamage = attacker.stats.attack * skill.power;
        const defense = defender.stats.defense;
        const typeModifier = this.getTypeModifier(skill.type, defender.type);
        
        const damage = Math.max(1, 
            Math.floor((baseDamage - defense * 0.5) * typeModifier)
        );

        return damage;
    }
}
```

### 2. å‰§æƒ…ç³»ç»Ÿ (src/story/)

#### StoryEngine.js - å‰§æƒ…å¼•æ“
```javascript
class StoryEngine {
    constructor() {
        this.storyDatabase = new StoryDatabase();
        this.currentStory = null;
        this.storyHistory = [];
        this.triggers = new Map();
        
        this.initializeTriggers();
    }

    // è§¦å‘å‰§æƒ…
    async triggerStory(triggerType, context) {
        const handler = this.triggers.get(triggerType);
        if (!handler) {
            console.warn(`æœªçŸ¥çš„å‰§æƒ…è§¦å‘å™¨: ${triggerType}`);
            return null;
        }

        try {
            const story = await handler(context);
            if (story) {
                this.currentStory = story;
                this.storyHistory.push({
                    story: story,
                    context: context,
                    timestamp: Date.now()
                });
            }
            return story;
        } catch (error) {
            console.error(`å‰§æƒ…ç”Ÿæˆå¤±è´¥: ${triggerType}`, error);
            return null;
        }
    }

    // å¤„ç†è¿›åŒ–å‰§æƒ…
    async handleEvolutionStory(context) {
        const { pet, evolutionType, newForm } = context;
        
        // é€‰æ‹©å‰§æƒ…æ¨¡æ¿
        const template = this.selectEvolutionTemplate(evolutionType);
        
        // ç”Ÿæˆä¸ªæ€§åŒ–å†…å®¹
        const story = await this.generateStoryFromTemplate(template, {
            petName: pet.name,
            petSpecies: pet.species,
            evolutionType: evolutionType,
            newForm: newForm
        });

        // æ·»åŠ ä¸–ç•Œè§‚èƒŒæ™¯
        story.worldContext = this.getWorldContext(evolutionType);
        
        return story;
    }

    // ç”Ÿæˆæ•…äº‹å†…å®¹
    async generateStoryFromTemplate(template, variables) {
        const story = {
            title: this.replaceVariables(template.title, variables),
            type: template.type,
            scenes: []
        };

        for (const scene of template.scenes) {
            const processedScene = {
                type: scene.type,
                content: this.replaceVariables(scene.content, variables)
            };

            if (scene.choices) {
                processedScene.choices = scene.choices.map(choice => ({
                    ...choice,
                    text: this.replaceVariables(choice.text, variables)
                }));
            }

            story.scenes.push(processedScene);
        }

        return story;
    }
}
```

### 3. è¿›åŒ–ç³»ç»Ÿ (src/game/EvolutionSystem.js)

#### ä¸‰å±‚AIæ¶æ„å®ç°
```javascript
class ThreeLayerEvolutionSystem {
    constructor() {
        this.L1_RecordLayer = new L1RecordLayer();
        this.L2_EvolutionLayer = new L2EvolutionLayer();
        this.L3_JudgmentLayer = new L3JudgmentLayer();
        
        this.evolutionTrees = new Map();
        this.behaviorWeights = this.initializeBehaviorWeights();
    }

    // L1å±‚ï¼šè®°å½•è¡Œä¸º
    recordBehavior(petId, behaviorType, context) {
        const behaviorData = {
            petId: petId,
            type: behaviorType,
            context: context,
            timestamp: Date.now(),
            weight: this.calculateBehaviorWeight(behaviorType, context)
        };

        this.L1_RecordLayer.addRecord(behaviorData);
        
        // è§¦å‘L2å±‚åˆ†æ
        this.scheduleAnalysis(petId);
    }

    // L2å±‚ï¼šåˆ†æè¿›åŒ–å€¾å‘
    async analyzeEvolutionTendency(petId) {
        const behaviors = this.L1_RecordLayer.getBehaviors(petId);
        const tendencies = this.L2_EvolutionLayer.analyzeTendencies(behaviors);
        
        // è®¡ç®—è¿›åŒ–æ¦‚ç‡
        const evolutionPaths = this.calculateEvolutionPaths(petId, tendencies);
        
        return {
            tendencies: tendencies,
            evolutionPaths: evolutionPaths,
            confidence: this.calculateConfidence(behaviors)
        };
    }

    // L3å±‚ï¼šæœ€ç»ˆå†³ç­–
    async makeEvolutionDecision(petId, analysisResult) {
        const pet = await this.getPet(petId);
        const decision = this.L3_JudgmentLayer.makeDecision(
            pet, 
            analysisResult,
            this.getEvolutionConstraints(pet)
        );

        if (decision.approved) {
            return await this.executeEvolution(petId, decision.evolutionPath);
        }

        return { success: false, reason: decision.reason };
    }

    // æ‰§è¡Œè¿›åŒ–
    async executeEvolution(petId, evolutionPath) {
        const pet = await this.getPet(petId);
        
        // åº”ç”¨è¿›åŒ–å˜åŒ–
        const newPet = this.applyEvolution(pet, evolutionPath);
        
        // æ›´æ–°æ•°æ®åº“
        await this.updatePet(petId, newPet);
        
        // è®°å½•è¿›åŒ–å†å²
        this.recordEvolutionHistory(petId, evolutionPath);
        
        return { success: true, newPet: newPet };
    }
}
```

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### SQLiteæ•°æ®åº“ç»“æ„

#### 1. ç©å®¶è¡¨ (players)
```sql
CREATE TABLE players (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100),
    level INTEGER DEFAULT 1,
    exp INTEGER DEFAULT 0,
    coins INTEGER DEFAULT 1000,
    gems INTEGER DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    last_login DATETIME,
    settings TEXT -- JSONæ ¼å¼çš„è®¾ç½®
);
```

#### 2. å® ç‰©è¡¨ (pets)
```sql
CREATE TABLE pets (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    player_id INTEGER NOT NULL,
    name VARCHAR(50) NOT NULL,
    species VARCHAR(50) NOT NULL,
    rarity VARCHAR(10) NOT NULL, -- N, R, SR, SSR, SSS
    level INTEGER DEFAULT 1,
    exp INTEGER DEFAULT 0,
    hp INTEGER NOT NULL,
    attack INTEGER NOT NULL,
    defense INTEGER NOT NULL,
    speed INTEGER NOT NULL,
    magic INTEGER NOT NULL,
    mood VARCHAR(20) DEFAULT 'neutral',
    bond INTEGER DEFAULT 0,
    traits TEXT, -- JSONæ•°ç»„
    personality TEXT,
    evolution_stage INTEGER DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (player_id) REFERENCES players(id)
);
```

#### 3. è¡Œä¸ºè®°å½•è¡¨ (behavior_records)
```sql
CREATE TABLE behavior_records (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    pet_id INTEGER NOT NULL,
    behavior_type VARCHAR(50) NOT NULL,
    context TEXT, -- JSONæ ¼å¼çš„ä¸Šä¸‹æ–‡
    weight REAL DEFAULT 1.0,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (pet_id) REFERENCES pets(id)
);
```

#### 4. è¿›åŒ–å†å²è¡¨ (evolution_history)
```sql
CREATE TABLE evolution_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    pet_id INTEGER NOT NULL,
    from_species VARCHAR(50) NOT NULL,
    to_species VARCHAR(50) NOT NULL,
    evolution_type VARCHAR(50) NOT NULL,
    trigger_conditions TEXT, -- JSONæ ¼å¼
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (pet_id) REFERENCES pets(id)
);
```

#### 5. å‰§æƒ…è¿›åº¦è¡¨ (story_progress)
```sql
CREATE TABLE story_progress (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    player_id INTEGER NOT NULL,
    story_id VARCHAR(100) NOT NULL,
    progress INTEGER DEFAULT 0,
    choices TEXT, -- JSONæ•°ç»„è®°å½•é€‰æ‹©
    completed BOOLEAN DEFAULT FALSE,
    started_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    completed_at DATETIME,
    FOREIGN KEY (player_id) REFERENCES players(id)
);
```

#### 6. æˆ˜æ–—è®°å½•è¡¨ (battle_records)
```sql
CREATE TABLE battle_records (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    player_id INTEGER NOT NULL,
    pet_id INTEGER NOT NULL,
    enemy_type VARCHAR(50) NOT NULL,
    enemy_level INTEGER NOT NULL,
    result VARCHAR(20) NOT NULL, -- victory, defeat, draw
    duration INTEGER, -- æˆ˜æ–—æŒç»­æ—¶é—´(ç§’)
    exp_gained INTEGER DEFAULT 0,
    rewards TEXT, -- JSONæ ¼å¼çš„å¥–åŠ±
    battle_log TEXT, -- JSONæ ¼å¼çš„æˆ˜æ–—æ—¥å¿—
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (player_id) REFERENCES players(id),
    FOREIGN KEY (pet_id) REFERENCES pets(id)
);
```

### æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
```sql
-- æ€§èƒ½ä¼˜åŒ–ç´¢å¼•
CREATE INDEX idx_pets_player_id ON pets(player_id);
CREATE INDEX idx_behavior_records_pet_id ON behavior_records(pet_id);
CREATE INDEX idx_behavior_records_timestamp ON behavior_records(timestamp);
CREATE INDEX idx_evolution_history_pet_id ON evolution_history(pet_id);
CREATE INDEX idx_story_progress_player_id ON story_progress(player_id);
CREATE INDEX idx_battle_records_player_id ON battle_records(player_id);
CREATE INDEX idx_battle_records_timestamp ON battle_records(timestamp);
```

---

## ğŸ”Œ APIæ¥å£è®¾è®¡

### RESTful APIè§„èŒƒ

#### åŸºç¡€è·¯å¾„
```
åŸºç¡€URL: https://api.lingjing-game.com/v1
è®¤è¯æ–¹å¼: Bearer Token (æœªæ¥ç‰ˆæœ¬)
å“åº”æ ¼å¼: JSON
```

#### 1. å® ç‰©ç›¸å…³æ¥å£

##### è·å–å® ç‰©åˆ—è¡¨
```http
GET /api/pets
Authorization: Bearer {token}

Response:
{
    "success": true,
    "data": [
        {
            "id": 1,
            "name": "å°ç«é¾™",
            "species": "ç«é¾™",
            "rarity": "R",
            "level": 5,
            "stats": { "hp": 100, "attack": 35, ... },
            "mood": "happy",
            "bond": 25
        }
    ],
    "total": 1
}
```

##### å¬å”¤å® ç‰©
```http
POST /api/pets/summon
Content-Type: application/json

Request:
{
    "summonType": "random", // random, legendary, stable, keyword
    "keyword": "é¾™", // ä»…keywordç±»å‹éœ€è¦
    "playerId": 1
}

Response:
{
    "success": true,
    "data": {
        "pet": { ... },
        "isNew": true,
        "rarity": "SR"
    }
}
```

##### å® ç‰©è¿›åŒ–
```http
POST /api/pets/{petId}/evolve
Content-Type: application/json

Request:
{
    "evolutionPath": "power_evolution",
    "confirm": true
}

Response:
{
    "success": true,
    "data": {
        "pet": { ... },
        "evolutionStory": { ... },
        "newAbilities": [ ... ]
    }
}
```

#### 2. å‰§æƒ…ç›¸å…³æ¥å£

##### è§¦å‘å‰§æƒ…
```http
POST /api/story/trigger
Content-Type: application/json

Request:
{
    "triggerType": "pet_evolution",
    "context": {
        "petId": 1,
        "evolutionType": "power_evolution"
    }
}

Response:
{
    "success": true,
    "data": {
        "story": {
            "title": "åŠ›é‡çš„è§‰é†’",
            "scenes": [ ... ],
            "choices": [ ... ]
        }
    }
}
```

##### æäº¤å‰§æƒ…é€‰æ‹©
```http
POST /api/story/choice
Content-Type: application/json

Request:
{
    "storyId": "story_123",
    "choiceId": "choice_1",
    "playerId": 1
}

Response:
{
    "success": true,
    "data": {
        "nextScene": { ... },
        "effects": { ... },
        "rewards": [ ... ]
    }
}
```

#### 3. AIç›¸å…³æ¥å£

##### ç”ŸæˆAIå¯¹è¯
```http
POST /api/ai/chat
Content-Type: application/json

Request:
{
    "petId": 1,
    "message": "ä½ å¥½å—ï¼Ÿ",
    "context": {
        "mood": "happy",
        "recentEvents": [ ... ]
    }
}

Response:
{
    "success": true,
    "data": {
        "response": "æˆ‘å¾ˆå¥½ï¼Œä¸»äººï¼ä»Šå¤©çš„å†’é™©è®©æˆ‘å¾ˆå…´å¥‹ï¼",
        "moodChange": "excited",
        "bondIncrease": 1
    }
}
```

##### è¿›åŒ–åˆ†æ
```http
POST /api/ai/evolution-analysis
Content-Type: application/json

Request:
{
    "petId": 1,
    "behaviorHistory": [ ... ]
}

Response:
{
    "success": true,
    "data": {
        "tendencies": {
            "power": 0.7,
            "wisdom": 0.3,
            "balance": 0.5
        },
        "evolutionPaths": [
            {
                "name": "åŠ›é‡è¿›åŒ–",
                "probability": 0.6,
                "requirements": [ ... ]
            }
        ]
    }
}
```

---

## ğŸ¨ å‰ç«¯æ¶æ„

### ç»„ä»¶åŒ–è®¾è®¡

#### 1. æ ¸å¿ƒç»„ä»¶ç»“æ„
```
src/frontend/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ GameInterface/
â”‚   â”‚   â”œâ”€â”€ StoryPanel.js
â”‚   â”‚   â”œâ”€â”€ PetPanel.js
â”‚   â”‚   â”œâ”€â”€ ChoicePanel.js
â”‚   â”‚   â””â”€â”€ ChatPanel.js
â”‚   â”œâ”€â”€ PetSystem/
â”‚   â”‚   â”œâ”€â”€ PetCard.js
â”‚   â”‚   â”œâ”€â”€ PetStats.js
â”‚   â”‚   â”œâ”€â”€ EvolutionTree.js
â”‚   â”‚   â””â”€â”€ SummonInterface.js
â”‚   â”œâ”€â”€ StorySystem/
â”‚   â”‚   â”œâ”€â”€ StoryRenderer.js
â”‚   â”‚   â”œâ”€â”€ DialogueBox.js
â”‚   â”‚   â”œâ”€â”€ ChoiceButton.js
â”‚   â”‚   â””â”€â”€ StoryHistory.js
â”‚   â””â”€â”€ Common/
â”‚       â”œâ”€â”€ LoadingSpinner.js
â”‚       â”œâ”€â”€ Modal.js
â”‚       â”œâ”€â”€ Notification.js
â”‚       â””â”€â”€ ProgressBar.js
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ ApiService.js
â”‚   â”œâ”€â”€ GameStateManager.js
â”‚   â”œâ”€â”€ StorageService.js
â”‚   â””â”€â”€ EventBus.js
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ formatters.js
â”‚   â”œâ”€â”€ validators.js
â”‚   â”œâ”€â”€ constants.js
â”‚   â””â”€â”€ helpers.js
â””â”€â”€ styles/
    â”œâ”€â”€ components/
    â”œâ”€â”€ themes/
    â””â”€â”€ animations/
```

#### 2. çŠ¶æ€ç®¡ç†
```javascript
class GameStateManager {
    constructor() {
        this.state = {
            player: null,
            currentPet: null,
            pets: [],
            currentStory: null,
            storyHistory: [],
            gameSettings: {},
            ui: {
                loading: false,
                activePanel: 'story',
                notifications: []
            }
        };
        
        this.listeners = new Map();
        this.middleware = [];
    }

    // çŠ¶æ€æ›´æ–°
    setState(updates) {
        const oldState = { ...this.state };
        this.state = { ...this.state, ...updates };
        
        // è§¦å‘ä¸­é—´ä»¶
        this.middleware.forEach(middleware => {
            middleware(oldState, this.state);
        });
        
        // é€šçŸ¥ç›‘å¬å™¨
        this.notifyListeners(oldState, this.state);
    }

    // è®¢é˜…çŠ¶æ€å˜åŒ–
    subscribe(key, callback) {
        if (!this.listeners.has(key)) {
            this.listeners.set(key, []);
        }
        this.listeners.get(key).push(callback);
    }

    // å–æ¶ˆè®¢é˜…
    unsubscribe(key, callback) {
        const callbacks = this.listeners.get(key);
        if (callbacks) {
            const index = callbacks.indexOf(callback);
            if (index > -1) {
                callbacks.splice(index, 1);
            }
        }
    }
}
```

#### 3. äº‹ä»¶ç³»ç»Ÿ
```javascript
class EventBus {
    constructor() {
        this.events = new Map();
    }

    // æ³¨å†Œäº‹ä»¶ç›‘å¬
    on(event, callback) {
        if (!this.events.has(event)) {
            this.events.set(event, []);
        }
        this.events.get(event).push(callback);
    }

    // è§¦å‘äº‹ä»¶
    emit(event, data) {
        const callbacks = this.events.get(event);
        if (callbacks) {
            callbacks.forEach(callback => {
                try {
                    callback(data);
                } catch (error) {
                    console.error(`äº‹ä»¶å¤„ç†é”™è¯¯ [${event}]:`, error);
                }
            });
        }
    }

    // ç§»é™¤äº‹ä»¶ç›‘å¬
    off(event, callback) {
        const callbacks = this.events.get(event);
        if (callbacks) {
            const index = callbacks.indexOf(callback);
            if (index > -1) {
                callbacks.splice(index, 1);
            }
        }
    }
}
```

---

## ğŸ¤– AIé›†æˆæ–¹æ¡ˆ

### DeepSeek APIé›†æˆ

#### 1. APIé…ç½®
```javascript
class AIService {
    constructor() {
        this.apiKey = process.env.DEEPSEEK_API_KEY;
        this.baseURL = 'https://api.deepseek.com/v1';
        this.model = 'deepseek-chat';
        this.requestCount = 0;
        this.cache = new Map();
    }

    // ç”Ÿæˆå‰§æƒ…å†…å®¹
    async generateStory(prompt, context = {}) {
        const cacheKey = this.generateCacheKey(prompt, context);
        
        // æ£€æŸ¥ç¼“å­˜
        if (this.cache.has(cacheKey)) {
            return this.cache.get(cacheKey);
        }

        try {
            const response = await this.makeRequest({
                model: this.model,
                messages: [
                    {
                        role: 'system',
                        content: this.getSystemPrompt('story_generation')
                    },
                    {
                        role: 'user',
                        content: this.formatPrompt(prompt, context)
                    }
                ],
                max_tokens: 800,
                temperature: 0.8
            });

            const result = this.parseStoryResponse(response);
            
            // ç¼“å­˜ç»“æœ
            this.cache.set(cacheKey, result);
            
            return result;
        } catch (error) {
            console.error('AIå‰§æƒ…ç”Ÿæˆå¤±è´¥:', error);
            return this.getFallbackStory(context);
        }
    }

    // ç”Ÿæˆå® ç‰©å¯¹è¯
    async generatePetResponse(petData, message, context = {}) {
        const prompt = this.buildPetChatPrompt(petData, message, context);
        
        try {
            const response = await this.makeRequest({
                model: this.model,
                messages: [
                    {
                        role: 'system',
                        content: this.getSystemPrompt('pet_chat')
                    },
                    {
                        role: 'user',
                        content: prompt
                    }
                ],
                max_tokens: 200,
                temperature: 0.9
            });

            return this.parsePetResponse(response, petData);
        } catch (error) {
            console.error('AIå¯¹è¯ç”Ÿæˆå¤±è´¥:', error);
            return this.getFallbackResponse(petData);
        }
    }

    // ç³»ç»Ÿæç¤ºè¯
    getSystemPrompt(type) {
        const prompts = {
            story_generation: `
ä½ æ˜¯ã€Šçµå¢ƒæ–—å® å½•ã€‹çš„å‰§æƒ…ç”ŸæˆAIã€‚è¯·åŸºäºä¸–ç•Œæ ‘ç§å­è¡ç”Ÿçš„å¥‡å¹»ä¸–ç•Œï¼Œ
ç»“åˆå±±æµ·ç»ç¥è¯å…ƒç´ ï¼Œç”Ÿæˆå¯Œæœ‰ç”»é¢æ„Ÿå’Œæ²‰æµ¸æ„Ÿçš„æ–‡å­—å†’é™©å†…å®¹ã€‚

è¦æ±‚ï¼š
1. æ–‡å­—ä¼˜ç¾ï¼Œå¯Œæœ‰è¯—æ„
2. æƒ…èŠ‚è¿è´¯ï¼Œé€»è¾‘åˆç†
3. ä½“ç°å±±æµ·ç»æ–‡åŒ–ç‰¹è‰²
4. è¥é€ ç¥ç§˜å¥‡å¹»çš„æ°›å›´
5. ä¸ºç©å®¶æä¾›æœ‰æ„ä¹‰çš„é€‰æ‹©
            `,
            pet_chat: `
ä½ æ˜¯å® ç‰©çš„AIäººæ ¼ã€‚è¯·æ ¹æ®å® ç‰©çš„ç§æ—ã€æ€§æ ¼ã€å¿ƒæƒ…ç­‰ä¿¡æ¯ï¼Œ
ç”Ÿæˆç¬¦åˆå…¶ç‰¹å¾çš„å¯¹è¯å›åº”ã€‚

è¦æ±‚ï¼š
1. ä½“ç°å® ç‰©çš„ç§æ—ç‰¹è‰²
2. åæ˜ å½“å‰å¿ƒæƒ…çŠ¶æ€
3. ä¿æŒè§’è‰²ä¸€è‡´æ€§
4. è¯­è¨€ç”ŸåŠ¨æœ‰è¶£
5. é€‚å½“è¡¨è¾¾å¯¹ä¸»äººçš„æ„Ÿæƒ…
            `
        };

        return prompts[type] || '';
    }
}
```

#### 2. é™çº§æœºåˆ¶
```javascript
class AIFallbackSystem {
    constructor() {
        this.templates = this.loadTemplates();
        this.randomResponses = this.loadRandomResponses();
    }

    // è·å–å¤‡ç”¨å‰§æƒ…
    getFallbackStory(context) {
        const templates = this.templates[context.type] || this.templates.default;
        const template = this.selectRandomTemplate(templates);
        
        return this.processTemplate(template, context);
    }

    // è·å–å¤‡ç”¨å¯¹è¯
    getFallbackResponse(petData) {
        const responses = this.randomResponses[petData.species] || 
                         this.randomResponses.default;
        
        return this.selectRandomResponse(responses, petData.mood);
    }

    // æ¨¡æ¿å¤„ç†
    processTemplate(template, context) {
        let content = template.content;
        
        // å˜é‡æ›¿æ¢
        Object.keys(context).forEach(key => {
            const regex = new RegExp(`{${key}}`, 'g');
            content = content.replace(regex, context[key]);
        });

        return {
            title: template.title,
            content: content,
            choices: template.choices || []
        };
    }
}
```

---

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### 1. å¼€å‘ç¯å¢ƒ
```yaml
# docker-compose.dev.yml
version: '3.8'
services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=development
      - DATABASE_URL=./data/game.db
    volumes:
      - .:/app
      - /app/node_modules
    command: npm run dev

  database:
    image: sqlite:latest
    volumes:
      - ./data:/data
```

### 2. ç”Ÿäº§ç¯å¢ƒ (Vercel)
```json
// vercel.json
{
  "version": 2,
  "builds": [
    {
      "src": "src/app.js",
      "use": "@vercel/node"
    },
    {
      "src": "public/**/*",
      "use": "@vercel/static"
    }
  ],
  "routes": [
    {
      "src": "/api/(.*)",
      "dest": "/src/app.js"
    },
    {
      "src": "/(.*)",
      "dest": "/public/$1"
    }
  ],
  "env": {
    "NODE_ENV": "production",
    "DEEPSEEK_API_KEY": "@deepseek-api-key"
  }
}
```

### 3. CI/CDæµç¨‹
```yaml
# .github/workflows/deploy.yml
name: Deploy to Vercel

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Setup Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '18'
    - name: Install dependencies
      run: npm ci
    - name: Run tests
      run: npm test
    - name: Run linting
      run: npm run lint

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
    - uses: actions/checkout@v2
    - name: Deploy to Vercel
      uses: amondnet/vercel-action@v20
      with:
        vercel-token: ${{ secrets.VERCEL_TOKEN }}
        vercel-org-id: ${{ secrets.ORG_ID }}
        vercel-project-id: ${{ secrets.PROJECT_ID }}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. å‰ç«¯ä¼˜åŒ–

#### ä»£ç åˆ†å‰²
```javascript
// åŠ¨æ€å¯¼å…¥
const StorySystem = lazy(() => import('./components/StorySystem'));
const EvolutionSystem = lazy(() => import('./components/EvolutionSystem'));

// è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
const routes = [
    {
        path: '/adventure',
        component: lazy(() => import('./pages/AdventurePage'))
    },
    {
        path: '/pets',
        component: lazy(() => import('./pages/PetsPage'))
    }
];
```

#### ç¼“å­˜ç­–ç•¥
```javascript
class CacheManager {
    constructor() {
        this.memoryCache = new Map();
        this.storageCache = new StorageCache();
        this.maxMemorySize = 50; // MB
    }

    // è®¾ç½®ç¼“å­˜
    set(key, value, ttl = 3600000) { // é»˜è®¤1å°æ—¶
        const item = {
            value: value,
            timestamp: Date.now(),
            ttl: ttl
        };

        this.memoryCache.set(key, item);
        this.storageCache.set(key, item);
        
        this.cleanupExpired();
    }

    // è·å–ç¼“å­˜
    get(key) {
        let item = this.memoryCache.get(key);
        
        if (!item) {
            item = this.storageCache.get(key);
            if (item) {
                this.memoryCache.set(key, item);
            }
        }

        if (item && this.isExpired(item)) {
            this.delete(key);
            return null;
        }

        return item ? item.value : null;
    }
}
```

### 2. åç«¯ä¼˜åŒ–

#### æ•°æ®åº“ä¼˜åŒ–
```javascript
class DatabaseOptimizer {
    constructor(db) {
        this.db = db;
        this.queryCache = new Map();
        this.connectionPool = this.createConnectionPool();
    }

    // æŸ¥è¯¢ç¼“å­˜
    async cachedQuery(sql, params = [], ttl = 300000) {
        const cacheKey = this.generateQueryKey(sql, params);
        
        if (this.queryCache.has(cacheKey)) {
            const cached = this.queryCache.get(cacheKey);
            if (Date.now() - cached.timestamp < ttl) {
                return cached.result;
            }
        }

        const result = await this.db.all(sql, params);
        
        this.queryCache.set(cacheKey, {
            result: result,
            timestamp: Date.now()
        });

        return result;
    }

    // æ‰¹é‡æ“ä½œ
    async batchInsert(table, records) {
        const placeholders = records.map(() => 
            `(${Object.keys(records[0]).map(() => '?').join(', ')})`
        ).join(', ');

        const sql = `INSERT INTO ${table} VALUES ${placeholders}`;
        const params = records.flatMap(record => Object.values(record));

        return await this.db.run(sql, params);
    }
}
```

#### APIå“åº”ä¼˜åŒ–
```javascript
class ResponseOptimizer {
    constructor() {
        this.compressionLevel = 6;
        this.cacheHeaders = {
            'Cache-Control': 'public, max-age=3600',
            'ETag': true
        };
    }

    // å“åº”å‹ç¼©
    compress(data) {
        if (typeof data === 'object') {
            data = JSON.stringify(data);
        }

        return gzip(data, { level: this.compressionLevel });
    }

    // åˆ†é¡µå“åº”
    paginate(data, page = 1, limit = 20) {
        const offset = (page - 1) * limit;
        const total = data.length;
        const pages = Math.ceil(total / limit);
        const items = data.slice(offset, offset + limit);

        return {
            data: items,
            pagination: {
                page: page,
                limit: limit,
                total: total,
                pages: pages,
                hasNext: page < pages,
                hasPrev: page > 1
            }
        };
    }
}
```

### 3. ç›‘æ§å’Œåˆ†æ

#### æ€§èƒ½ç›‘æ§
```javascript
class PerformanceMonitor {
    constructor() {
        this.metrics = new Map();
        this.alerts = [];
    }

    // è®°å½•æ€§èƒ½æŒ‡æ ‡
    recordMetric(name, value, tags = {}) {
        const metric = {
            name: name,
            value: value,
            tags: tags,
            timestamp: Date.now()
        };

        if (!this.metrics.has(name)) {
            this.metrics.set(name, []);
        }

        this.metrics.get(name).push(metric);
        this.checkAlerts(metric);
    }

    // è·å–æ€§èƒ½æŠ¥å‘Š
    getReport(timeRange = 3600000) { // é»˜è®¤1å°æ—¶
        const now = Date.now();
        const report = {};

        this.metrics.forEach((values, name) => {
            const recentValues = values.filter(
                v => now - v.timestamp < timeRange
            );

            if (recentValues.length > 0) {
                report[name] = {
                    count: recentValues.length,
                    average: this.calculateAverage(recentValues),
                    min: Math.min(...recentValues.map(v => v.value)),
                    max: Math.max(...recentValues.map(v => v.value))
                };
            }
        });

        return report;
    }
}
```

---

## ğŸ“Š æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•
```javascript
// tests/unit/PetManager.test.js
describe('PetManager', () => {
    let petManager;
    let mockDatabase;

    beforeEach(() => {
        mockDatabase = new MockDatabase();
        petManager = new PetManager(mockDatabase);
    });

    test('should create pet with correct attributes', async () => {
        const template = {
            name: 'å°ç«é¾™',
            species: 'ç«é¾™',
            rarity: 'R',
            baseStats: { hp: 100, attack: 30 }
        };

        const pet = await petManager.createPet(template, 1);

        expect(pet.name).toBe('å°ç«é¾™');
        expect(pet.species).toBe('ç«é¾™');
        expect(pet.rarity).toBe('R');
        expect(pet.stats.hp).toBe(100);
    });

    test('should level up pet correctly', async () => {
        const pet = await petManager.createPet(mockTemplate, 1);
        const leveledPet = await petManager.levelUp(pet.id);

        expect(leveledPet.level).toBe(2);
        expect(leveledPet.exp).toBe(0);
        expect(leveledPet.stats.hp).toBeGreaterThan(pet.stats.hp);
    });
});
```

### 2. é›†æˆæµ‹è¯•
```javascript
// tests/integration/StorySystem.test.js
describe('Story System Integration', () => {
    let app;
    let request;

    beforeAll(async () => {
        app = await createTestApp();
        request = supertest(app);
    });

    test('should trigger evolution story', async () => {
        const response = await request
            .post('/api/story/trigger')
            .send({
                triggerType: 'pet_evolution',
                context: {
                    petId: 1,
                    evolutionType: 'power_evolution'
                }
            });

        expect(response.status).toBe(200);
        expect(response.body.success).toBe(true);
        expect(response.body.data.story).toBeDefined();
        expect(response.body.data.story.title).toContain('è¿›åŒ–');
    });
});
```

### 3. ç«¯åˆ°ç«¯æµ‹è¯•
```javascript
// tests/e2e/GameFlow.test.js
describe('Complete Game Flow', () => {
    let browser;
    let page;

    beforeAll(async () => {
        browser = await puppeteer.launch();
        page = await browser.newPage();
    });

    test('should complete pet summoning flow', async () => {
        await page.goto('http://localhost:3000');
        
        // ç‚¹å‡»å¬å”¤æŒ‰é’®
        await page.click('[data-testid="summon-random"]');
        
        // ç­‰å¾…å® ç‰©å‡ºç°
        await page.waitForSelector('[data-testid="pet-card"]');
        
        // éªŒè¯å® ç‰©ä¿¡æ¯
        const petName = await page.$eval(
            '[data-testid="pet-name"]', 
            el => el.textContent
        );
        
        expect(petName).toBeTruthy();
    });
});
```

---

## ğŸ”’ å®‰å…¨è€ƒè™‘

### 1. æ•°æ®éªŒè¯
```javascript
class InputValidator {
    static validatePetName(name) {
        if (!name || typeof name !== 'string') {
            throw new Error('å® ç‰©åç§°å¿…é¡»æ˜¯å­—ç¬¦ä¸²');
        }
        
        if (name.length < 1 || name.length > 20) {
            throw new Error('å® ç‰©åç§°é•¿åº¦å¿…é¡»åœ¨1-20å­—ç¬¦ä¹‹é—´');
        }
        
        if (!/^[\u4e00-\u9fa5a-zA-Z0-9\s]+$/.test(name)) {
            throw new Error('å® ç‰©åç§°åŒ…å«éæ³•å­—ç¬¦');
        }
        
        return true;
    }

    static validateChoice(choice) {
        const validChoices = [
            'random_summon', 'legendary_summon', 
            'stable_summon', 'keyword_summon'
        ];
        
        if (!validChoices.includes(choice)) {
            throw new Error('æ— æ•ˆçš„é€‰æ‹©');
        }
        
        return true;
    }
}
```

### 2. é€Ÿç‡é™åˆ¶
```javascript
class RateLimiter {
    constructor() {
        this.requests = new Map();
        this.limits = {
            summon: { max: 10, window: 3600000 }, // æ¯å°æ—¶10æ¬¡
            chat: { max: 100, window: 3600000 },   // æ¯å°æ—¶100æ¬¡
            evolution: { max: 5, window: 3600000 } // æ¯å°æ—¶5æ¬¡
        };
    }

    checkLimit(userId, action) {
        const key = `${userId}:${action}`;
        const now = Date.now();
        const limit = this.limits[action];

        if (!limit) return true;

        if (!this.requests.has(key)) {
            this.requests.set(key, []);
        }

        const requests = this.requests.get(key);
        
        // æ¸…ç†è¿‡æœŸè¯·æ±‚
        const validRequests = requests.filter(
            time => now - time < limit.window
        );

        if (validRequests.length >= limit.max) {
            throw new Error(`æ“ä½œè¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•`);
        }

        validRequests.push(now);
        this.requests.set(key, validRequests);
        
        return true;
    }
}
```

---

## ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—

### 1. æ—¥å¿—ç³»ç»Ÿ
```javascript
class Logger {
    constructor() {
        this.winston = require('winston');
        this.logger = this.winston.createLogger({
            level: 'info',
            format: this.winston.format.combine(
                this.winston.format.timestamp(),
                this.winston.format.errors({ stack: true }),
                this.winston.format.json()
            ),
            transports: [
                new this.winston.transports.File({ 
                    filename: 'logs/error.log', 
                    level: 'error' 
                }),
                new this.winston.transports.File({ 
                    filename: 'logs/combined.log' 
                })
            ]
        });

        if (process.env.NODE_ENV !== 'production') {
            this.logger.add(new this.winston.transports.Console({
                format: this.winston.format.simple()
            }));
        }
    }

    info(message, meta = {}) {
        this.logger.info(message, meta);
    }

    error(message, error = null, meta = {}) {
        this.logger.error(message, { 
            error: error ? error.stack : null, 
            ...meta 
        });
    }

    warn(message, meta = {}) {
        this.logger.warn(message, meta);
    }
}
```

### 2. é”™è¯¯è¿½è¸ª
```javascript
class ErrorTracker {
    constructor() {
        this.errors = [];
        this.maxErrors = 1000;
    }

    trackError(error, context = {}) {
        const errorInfo = {
            message: error.message,
            stack: error.stack,
            context: context,
            timestamp: new Date().toISOString(),
            id: this.generateErrorId()
        };

        this.errors.unshift(errorInfo);
        
        if (this.errors.length > this.maxErrors) {
            this.errors = this.errors.slice(0, this.maxErrors);
        }

        // å‘é€åˆ°å¤–éƒ¨é”™è¯¯è¿½è¸ªæœåŠ¡
        this.sendToExternalService(errorInfo);
        
        return errorInfo.id;
    }

    getErrorReport(timeRange = 86400000) { // 24å°æ—¶
        const now = Date.now();
        const recentErrors = this.errors.filter(error => 
            now - new Date(error.timestamp).getTime() < timeRange
        );

        return {
            total: recentErrors.length,
            byType: this.groupErrorsByType(recentErrors),
            recent: recentErrors.slice(0, 10)
        };
    }
}
```

---

è¿™ä»½æŠ€æœ¯å®ç°æ–‡æ¡£è¯¦ç»†æè¿°äº†ã€Šçµå¢ƒæ–—å® å½•ã€‹çš„æŠ€æœ¯æ¶æ„å’Œå®ç°æ–¹æ¡ˆã€‚æ–‡æ¡£æ¶µç›–äº†ä»ç³»ç»Ÿæ¶æ„åˆ°å…·ä½“ä»£ç å®ç°çš„å„ä¸ªå±‚é¢ï¼Œä¸ºå¼€å‘å›¢é˜Ÿæä¾›äº†å®Œæ•´çš„æŠ€æœ¯æŒ‡å¯¼ã€‚

**æ–‡æ¡£ç‰¹ç‚¹**ï¼š
- å®Œæ•´çš„ç³»ç»Ÿæ¶æ„è®¾è®¡
- è¯¦ç»†çš„ä»£ç å®ç°ç¤ºä¾‹
- å…¨é¢çš„æ•°æ®åº“è®¾è®¡
- æ ‡å‡†çš„APIæ¥å£è§„èŒƒ
- å®Œå–„çš„æµ‹è¯•å’Œéƒ¨ç½²ç­–ç•¥
- å……åˆ†çš„å®‰å…¨å’Œæ€§èƒ½è€ƒè™‘

è¿™ä»½æ–‡æ¡£å°†ä½œä¸ºé¡¹ç›®å¼€å‘çš„æŠ€æœ¯è“å›¾ï¼Œç¡®ä¿ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œç¨³å®šæ€§ã€‚