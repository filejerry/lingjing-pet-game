{"version":3,"file":"pet-B_LAlSfv.js","sources":["../../../client/src/services/api.ts","../../../client/src/services/petService.ts","../../../client/src/stores/pet.ts"],"sourcesContent":["/**\r\n * Axios API ÂÆ¢Êà∑Á´ØÈÖçÁΩÆ\r\n */\r\n\r\nimport axios, { AxiosError, AxiosResponse, InternalAxiosRequestConfig } from 'axios'\r\nimport router from '@/router'\r\n\r\nconst apiClient = axios.create({\r\n  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api',\r\n  timeout: 10000,\r\n  headers: {\r\n    'Content-Type': 'application/json'\r\n  }\r\n})\r\n\r\n// ËØ∑Ê±ÇÊã¶Êà™Âô®\r\napiClient.interceptors.request.use(\r\n  (config: InternalAxiosRequestConfig) => {\r\n    // Ê∑ªÂä†ËÆ§ËØÅtoken\r\n    const token = localStorage.getItem('auth_token')\r\n    if (token && config.headers) {\r\n      config.headers.Authorization = `Bearer ${token}`\r\n    }\r\n\r\n    // ËØ∑Ê±ÇÊó•Âøó\r\n    console.log(`üì§ APIËØ∑Ê±Ç: ${config.method?.toUpperCase()} ${config.url}`)\r\n\r\n    return config\r\n  },\r\n  (error: AxiosError) => {\r\n    console.error('‚ùå ËØ∑Ê±ÇÈîôËØØ:', error)\r\n    return Promise.reject(error)\r\n  }\r\n)\r\n\r\n// ÂìçÂ∫îÊã¶Êà™Âô®\r\napiClient.interceptors.response.use(\r\n  (response: AxiosResponse) => {\r\n    // ÂìçÂ∫îÊó•Âøó\r\n    console.log(`üì• APIÂìçÂ∫î: ${response.config.url} - ${response.status}`)\r\n    return response\r\n  },\r\n  (error: AxiosError) => {\r\n    console.error('‚ùå ÂìçÂ∫îÈîôËØØ:', error)\r\n\r\n    // Â§ÑÁêÜHTTPÈîôËØØ\r\n    if (error.response) {\r\n      switch (error.response.status) {\r\n        case 401:\r\n          // Êú™ÊéàÊùÉ,Ë∑≥ËΩ¨ÁôªÂΩï\r\n          localStorage.removeItem('auth_token')\r\n          router.push('/login')\r\n          break\r\n        case 403:\r\n          // Á¶ÅÊ≠¢ËÆøÈóÆ\r\n          console.error('Ê≤°ÊúâÊùÉÈôêËÆøÈóÆÊ≠§ËµÑÊ∫ê')\r\n          break\r\n        case 404:\r\n          // ËµÑÊ∫ê‰∏çÂ≠òÂú®\r\n          console.error('ËØ∑Ê±ÇÁöÑËµÑÊ∫ê‰∏çÂ≠òÂú®')\r\n          break\r\n        case 500:\r\n          // ÊúçÂä°Âô®ÈîôËØØ\r\n          console.error('ÊúçÂä°Âô®ÂÜÖÈÉ®ÈîôËØØ')\r\n          break\r\n        default:\r\n          console.error(`HTTPÈîôËØØ: ${error.response.status}`)\r\n      }\r\n    } else if (error.request) {\r\n      // ËØ∑Ê±ÇÂ∑≤ÂèëÈÄÅ‰ΩÜÊó†ÂìçÂ∫î\r\n      console.error('ÁΩëÁªúÈîôËØØ,ËØ∑Ê£ÄÊü•ËøûÊé•')\r\n    } else {\r\n      // ÂÖ∂‰ªñÈîôËØØ\r\n      console.error('ËØ∑Ê±ÇÈÖçÁΩÆÈîôËØØ:', error.message)\r\n    }\r\n\r\n    return Promise.reject(error)\r\n  }\r\n)\r\n\r\nexport default apiClient\r\n","/**\r\n * ÂÆ†Áâ©Áõ∏ÂÖ≥APIÊúçÂä°\r\n */\r\n\r\nimport apiClient from './api'\r\nimport type { Pet, EvolutionCandidate } from '@/types/pet'\r\n\r\nexport const petService = {\r\n  /**\r\n   * Ëé∑ÂèñÂÆ†Áâ©ËØ¶ÊÉÖ\r\n   */\r\n  getPet(petId: string) {\r\n    return apiClient.get<Pet>(`/pets/${petId}`)\r\n  },\r\n\r\n  /**\r\n   * Ëé∑ÂèñÂÆ†Áâ©ÂàóË°®\r\n   */\r\n  getPetList() {\r\n    return apiClient.get<Pet[]>('/pets')\r\n  },\r\n\r\n  /**\r\n   * ÂàõÂª∫ÂÆ†Áâ©\r\n   */\r\n  createPet(template: any) {\r\n    return apiClient.post<Pet>('/pets/create', template)\r\n  },\r\n\r\n  /**\r\n   * ÂÆ†Áâ©ËøõÂåñ\r\n   */\r\n  evolve(petId: string, evolutionPath: string) {\r\n    return apiClient.post<Pet>(`/pets/${petId}/evolve`, { evolutionPath })\r\n  },\r\n\r\n  /**\r\n   * Ëé∑ÂèñËøõÂåñÂÄôÈÄâ\r\n   */\r\n  getEvolutionCandidates(petId: string) {\r\n    return apiClient.get<EvolutionCandidate>(`/pets/${petId}/evolution-candidates`)\r\n  },\r\n\r\n  /**\r\n   * ÂñÇÈ£üÂÆ†Áâ©\r\n   */\r\n  feedPet(petId: string, foodId: string) {\r\n    return apiClient.post(`/pets/${petId}/feed`, { foodId })\r\n  },\r\n\r\n  /**\r\n   * ‰∏éÂÆ†Áâ©ËÅäÂ§©\r\n   */\r\n  chatWithPet(petId: string, message: string) {\r\n    return apiClient.post<{ reply: string }>(`/pets/${petId}/chat`, { message })\r\n  },\r\n\r\n  /**\r\n   * Êõ¥Êñ∞ÂÆ†Áâ©Â±ûÊÄß\r\n   */\r\n  updatePetStats(petId: string, stats: any) {\r\n    return apiClient.patch(`/pets/${petId}/stats`, stats)\r\n  }\r\n}\r\n","import { defineStore } from 'pinia'\r\nimport type { Pet, PetStats, EvolutionCandidate } from '@/types/pet'\r\nimport { petService } from '@/services/petService'\r\n\r\nexport const usePetStore = defineStore('pet', {\r\n  state: () => ({\r\n    currentPet: null as Pet | null,\r\n    petList: [] as Pet[],\r\n    evolutionCandidates: null as EvolutionCandidate | null,\r\n    loading: false,\r\n    error: null as string | null\r\n  }),\r\n\r\n  getters: {\r\n    hasPet: (state) => state.currentPet !== null,\r\n\r\n    petStats: (state): PetStats | null => {\r\n      return state.currentPet?.stats || null\r\n    },\r\n\r\n    canEvolve: (state): boolean => {\r\n      if (!state.currentPet) return false\r\n      return state.currentPet.exp >= 100 && state.currentPet.level >= 10\r\n    },\r\n\r\n    rarityColor: (state): string => {\r\n      if (!state.currentPet) return '#9CA3AF'\r\n      const colors = {\r\n        N: '#9CA3AF',\r\n        R: '#3B82F6',\r\n        SR: '#8B5CF6',\r\n        SSR: '#EF4444',\r\n        SSS: 'linear-gradient(90deg, #FF0080, #FF8C00, #FFD700)'\r\n      }\r\n      return colors[state.currentPet.rarity]\r\n    }\r\n  },\r\n\r\n  actions: {\r\n    async fetchPet(petId: string) {\r\n      this.loading = true\r\n      this.error = null\r\n      try {\r\n        const response = await petService.getPet(petId)\r\n        this.currentPet = response.data\r\n      } catch (error: any) {\r\n        this.error = error.message || 'Ëé∑ÂèñÂÆ†Áâ©‰ø°ÊÅØÂ§±Ë¥•'\r\n        throw error\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    async fetchPetList() {\r\n      this.loading = true\r\n      this.error = null\r\n      try {\r\n        const response = await petService.getPetList()\r\n        this.petList = response.data\r\n      } catch (error: any) {\r\n        this.error = error.message || 'Ëé∑ÂèñÂÆ†Áâ©ÂàóË°®Â§±Ë¥•'\r\n        throw error\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    async createPet(template: any) {\r\n      this.loading = true\r\n      this.error = null\r\n      try {\r\n        const response = await petService.createPet(template)\r\n        this.currentPet = response.data\r\n        this.petList.push(response.data)\r\n        return response.data\r\n      } catch (error: any) {\r\n        this.error = error.message || 'ÂàõÂª∫ÂÆ†Áâ©Â§±Ë¥•'\r\n        throw error\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    async evolve(evolutionPath: string) {\r\n      if (!this.currentPet) {\r\n        throw new Error('Ê≤°ÊúâÈÄâ‰∏≠ÁöÑÂÆ†Áâ©')\r\n      }\r\n\r\n      this.loading = true\r\n      this.error = null\r\n      try {\r\n        const response = await petService.evolve(this.currentPet.id, evolutionPath)\r\n        this.currentPet = response.data\r\n\r\n        // Êõ¥Êñ∞ÂàóË°®‰∏≠ÁöÑÂÆ†Áâ©\r\n        const index = this.petList.findIndex(p => p.id === this.currentPet!.id)\r\n        if (index !== -1) {\r\n          this.petList[index] = response.data\r\n        }\r\n\r\n        return response.data\r\n      } catch (error: any) {\r\n        this.error = error.message || 'ËøõÂåñÂ§±Ë¥•'\r\n        throw error\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    async getEvolutionCandidates(petId: string) {\r\n      this.loading = true\r\n      this.error = null\r\n      try {\r\n        const response = await petService.getEvolutionCandidates(petId)\r\n        this.evolutionCandidates = response.data\r\n        return response.data\r\n      } catch (error: any) {\r\n        this.error = error.message || 'Ëé∑ÂèñËøõÂåñÂÄôÈÄâÂ§±Ë¥•'\r\n        throw error\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    updatePetStats(delta: Partial<PetStats>) {\r\n      if (!this.currentPet) return\r\n\r\n      Object.keys(delta).forEach(key => {\r\n        const statKey = key as keyof PetStats\r\n        if (this.currentPet!.stats[statKey] !== undefined) {\r\n          this.currentPet!.stats[statKey] += delta[statKey]!\r\n        }\r\n      })\r\n    },\r\n\r\n    updatePetExp(expGain: number) {\r\n      if (!this.currentPet) return\r\n\r\n      this.currentPet.exp += expGain\r\n\r\n      // Ê£ÄÊü•ÂçáÁ∫ß\r\n      const levelUpExp = this.currentPet.level * 100\r\n      if (this.currentPet.exp >= levelUpExp) {\r\n        this.currentPet.level += 1\r\n        this.currentPet.exp -= levelUpExp\r\n      }\r\n    }\r\n  }\r\n})\r\n"],"names":["apiClient","axios","config","token","_a","error","response","router","petService","petId","template","evolutionPath","foodId","message","stats","usePetStore","defineStore","state","index","p","delta","key","statKey","expGain","levelUpExp"],"mappings":"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"}