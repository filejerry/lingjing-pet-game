import{d as n}from"./vue-vendor-BrcR7j7v.js";import{a as i}from"./ui-vendor-B9ygI19o.js";import{r as l}from"./index-D-xWN9oA.js";const r=i.create({baseURL:"https://api.yourdomain.com/api",timeout:1e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(t=>{var s;const e=localStorage.getItem("auth_token");return e&&t.headers&&(t.headers.Authorization=`Bearer ${e}`),console.log(`ðŸ“¤ APIè¯·æ±‚: ${(s=t.method)==null?void 0:s.toUpperCase()} ${t.url}`),t},t=>(console.error("âŒ è¯·æ±‚é”™è¯¯:",t),Promise.reject(t)));r.interceptors.response.use(t=>(console.log(`ðŸ“¥ APIå“åº”: ${t.config.url} - ${t.status}`),t),t=>{if(console.error("âŒ å“åº”é”™è¯¯:",t),t.response)switch(t.response.status){case 401:localStorage.removeItem("auth_token"),l.push("/login");break;case 403:console.error("æ²¡æœ‰æƒé™è®¿é—®æ­¤èµ„æº");break;case 404:console.error("è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨");break;case 500:console.error("æœåŠ¡å™¨å†…éƒ¨é”™è¯¯");break;default:console.error(`HTTPé”™è¯¯: ${t.response.status}`)}else t.request?console.error("ç½‘ç»œé”™è¯¯,è¯·æ£€æŸ¥è¿žæŽ¥"):console.error("è¯·æ±‚é…ç½®é”™è¯¯:",t.message);return Promise.reject(t)});const a={getPet(t){return r.get(`/pets/${t}`)},getPetList(){return r.get("/pets")},createPet(t){return r.post("/pets/create",t)},evolve(t,e){return r.post(`/pets/${t}/evolve`,{evolutionPath:e})},getEvolutionCandidates(t){return r.get(`/pets/${t}/evolution-candidates`)},feedPet(t,e){return r.post(`/pets/${t}/feed`,{foodId:e})},chatWithPet(t,e){return r.post(`/pets/${t}/chat`,{message:e})},updatePetStats(t,e){return r.patch(`/pets/${t}/stats`,e)}},p=n("pet",{state:()=>({currentPet:null,petList:[],evolutionCandidates:null,loading:!1,error:null}),getters:{hasPet:t=>t.currentPet!==null,petStats:t=>{var e;return((e=t.currentPet)==null?void 0:e.stats)||null},canEvolve:t=>t.currentPet?t.currentPet.exp>=100&&t.currentPet.level>=10:!1,rarityColor:t=>t.currentPet?{N:"#9CA3AF",R:"#3B82F6",SR:"#8B5CF6",SSR:"#EF4444",SSS:"linear-gradient(90deg, #FF0080, #FF8C00, #FFD700)"}[t.currentPet.rarity]:"#9CA3AF"},actions:{async fetchPet(t){this.loading=!0,this.error=null;try{const e=await a.getPet(t);this.currentPet=e.data}catch(e){throw this.error=e.message||"èŽ·å–å® ç‰©ä¿¡æ¯å¤±è´¥",e}finally{this.loading=!1}},async fetchPetList(){this.loading=!0,this.error=null;try{const t=await a.getPetList();this.petList=t.data}catch(t){throw this.error=t.message||"èŽ·å–å® ç‰©åˆ—è¡¨å¤±è´¥",t}finally{this.loading=!1}},async createPet(t){this.loading=!0,this.error=null;try{const e=await a.createPet(t);return this.currentPet=e.data,this.petList.push(e.data),e.data}catch(e){throw this.error=e.message||"åˆ›å»ºå® ç‰©å¤±è´¥",e}finally{this.loading=!1}},async evolve(t){if(!this.currentPet)throw new Error("æ²¡æœ‰é€‰ä¸­çš„å® ç‰©");this.loading=!0,this.error=null;try{const e=await a.evolve(this.currentPet.id,t);this.currentPet=e.data;const s=this.petList.findIndex(o=>o.id===this.currentPet.id);return s!==-1&&(this.petList[s]=e.data),e.data}catch(e){throw this.error=e.message||"è¿›åŒ–å¤±è´¥",e}finally{this.loading=!1}},async getEvolutionCandidates(t){this.loading=!0,this.error=null;try{const e=await a.getEvolutionCandidates(t);return this.evolutionCandidates=e.data,e.data}catch(e){throw this.error=e.message||"èŽ·å–è¿›åŒ–å€™é€‰å¤±è´¥",e}finally{this.loading=!1}},updatePetStats(t){this.currentPet&&Object.keys(t).forEach(e=>{const s=e;this.currentPet.stats[s]!==void 0&&(this.currentPet.stats[s]+=t[s])})},updatePetExp(t){if(!this.currentPet)return;this.currentPet.exp+=t;const e=this.currentPet.level*100;this.currentPet.exp>=e&&(this.currentPet.level+=1,this.currentPet.exp-=e)}}});export{p as u};
//# sourceMappingURL=pet-B_LAlSfv.js.map
